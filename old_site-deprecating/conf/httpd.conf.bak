# ------------------------------------------------------------
#            WORMBASE HTTPD CONFIGURATION FILE
# ------------------------------------------------------------
# $Id: httpd.conf,v 1.44 2007/10/24 14:45:55 todd Exp $
#

PerlRequire /usr/local/wormbase/conf/perl.startup

ServerName dev.wormbase.org
ServerAdmin webmaster@wormbase.org

DocumentRoot /usr/local/wormbase/html
LogFormat "%h %l %u %t \"%r\" %s %b" common
LogFormat "%h %l %u %t %{Referer}i \"%{User-Agent}i\" \"%r\" %s %b" combined_format
LogFormat "witheld %l %u %t \"%r\" %s %b" anonymous

ErrorLog     /usr/local/wormbase/logs/error_log
#CustomLog    /usr/local/wormbase/logs/access_log common
CustomLog    /usr/local/wormbase/logs/access_log combined_format

Redirect /perl/ace/elegans/ http://dev.wormbase.org/db/
Redirect /cb/gbrowse        http://dev.wormbase.org/db/seq/gbrowse?source=briggsae
Redirect /wiki             http://www.wormbase.org/wiki

# DAV configuration - primarily used by Caltech to add new images
DAVLockDB /usr/local/wormbase/logs/DAVLock
Alias /dav/expression  /usr/local/wormbase/html/images/expression_patterns
<Location /dav/expression>
   DAV on
   AuthType Basic
   AuthName "WB Expression Patterns"
   AuthUserFile /usr/local/wormbase/conf/htpasswd-dav
    <Limit GET OPTIONS PUT POST DELETE PROPFIND PROPPATCH MKCOL COPY MOVE LOCK UNLOCK>
#    <LimitExcept GET HEAD OPTIONS>
        Require user caltech
#    </LimitExcept>
     </Limit>
</Location>

# Private WormBase DAV directory
<Location /private>
   DAV On
   Options +Indexes
   AuthType Basic
   AuthName "WB Private Archive"
   AuthUserFile /usr/local/wormbase/conf/htpasswd-dav
    <Limit GET OPTIONS PUT POST DELETE PROPFIND PROPPATCH MKCOL COPY MOVE LOCK UNLOCK>
       Require user wormbase
    </Limit>
</Location>

<Location /ngasp>
  Options +Indexes
  SetHandler None
  AuthType Basic
  AuthName "nGASP Development"
  AuthUserFile /usr/local/wormbase/conf/htpasswd
  Require user ngasp
</Location>

<Location /ngasp/submission>
   DAV On
   AllowOverride None
   AuthType Basic
   AuthName "nGASP gene predictions"
   AuthUserFile /usr/local/wormbase/conf/htpasswd-dav
   <Limit OPTIONS GET DELETE PUT POST PROPFIND PROPPATCH MKCOL COPY MOVE LOCK UNLOCK>
       Require user ngasp-entry
   </Limit>
</Location>


<Location /todd>
   DAV On
#   Options +Indexes
   AuthType Basic
   AuthName "Todd's WebDAV"
   AuthUserFile /usr/local/wormbase/conf/htpasswd-dav
    <LimitExcept GET HEAD>
        Require user todd
    </LimitExcept>
</Location>

#control access to C. remanei annotation databases
<Location /db/seq/gbrowse/remanei_pcap_clean>
    Order deny,allow
    Deny from all
</Location>

<Location /das>
     SetHandler None
     ForceType  application/x-das
     Action application/x-das /cgi-bin/das2.cgi
</Location>

<Location /genome>
     SetHandler None
     ForceType application/x-genome-dumper
     Action application/x-genome-dumper /db/misc/standard_urls
</Location> 

#<Location /genome>
#     SetHandler None
#     ForceType  application/x-genome-dumper
#     Action application/x-genome-dumper /db/searches/standard_urls
#</Location>

<Location /proteome>
     SetHandler None
     ForceType  application/x-proteome-dumper
     Action application/x-proteome-dumper /db/searches/standard_urls
</Location>

<Location /transcriptome>
     SetHandler None
     ForceType  application/x-transcriptome-dumper
     Action application/x-transcriptome-dumper /db/searches/standard_urls
</Location>

<Location /laboratories>
     SetHandler None
     ForceType application/x-laboratories-dumper
     Action application/x-laboratories-dumper /db/searches/dump_laboratories
</Location>

<Location /version>
     SetHandler None
     ForceType application/x-version-dumper
     Action application/x-version-dumper /db/gmod/version
</Location>

<Location /defaults>
     SetHandler None
     ForceType application/x-version-dumper
     Action application/x-version-dumper /db/gmod/defaults
</Location>

<Location /SR_expression>
     SetHandler None
     ForceType application/x-sr-expression
     #Action application/x-sr-expression /db/SR_expression/SRsubmit.pl
     Action application/x-sr-expression /wormbase/SR.html
     AuthName "SR Expression Project"
     AuthType Basic
     AuthUserFile /usr/local/wormbase/conf/htpasswd
     require user receptor
</Location>

<Location /db/das/protected>
	AuthName "Protected DAS DSN"
	AuthType Basic
	AuthUserFile /usr/local/wormbase/conf/htpasswd
	require user testuser
</Location>
#<Location /db/das/elegans>
#	AuthName "Elegans DAS DSN"
#	AuthType Basic
#	AuthUserFile /usr/local/wormbase/conf/htpasswd
#	require	user wormbase
#</Location>

<Directory /usr/local/wormbase/cgi-perl/private>
#    SetHandler     perl-script
#    PerlHandler    Apache::Registry
    AuthType       Basic
    AuthName       "WormBase Administrative Archive"
    AuthUserFile   /usr/local/wormbase/conf/htpasswd
    Require        valid-user
</Directory>

<Directory /usr/local/wormbase/html/stats>
    AuthType       Basic
    AuthName       "WormBase Release Statistics"
    AuthUserFile   /usr/local/wormbase/conf/htpasswd
    Require        valid-user
</Directory>

<Directory /usr/local/wormbase/html/mailarch/wormbase-dev>
	AuthName "Restricted mailing list archives for WormBase developers"
	AuthType Basic
	AuthUserFile /usr/local/wormbase/conf/htpasswd
	require	user wormbase
</Directory>

<Directory /usr/local/wormbase/html/mailarch/wormbase-help>
	AuthName "WormBase-help mailing list archives. Log in using wormbase as the username and password."
	AuthType Basic
	AuthUserFile /usr/local/wormbase/conf/htpasswd-open
	require	user wormbase
</Directory>

<Directory /usr/local/wormbase/html/mailarch/wormbase-models>
        AuthName "WormBase-models mailing list archives. Log in using wormbase as the username and password."
        AuthType Basic
        AuthUserFile /usr/local/wormbase/conf/htpasswd-open
        require user wormbase
</Directory> 

<Directory /usr/local/wormbase/html/mailarch/wormbase-cvs>
	AuthName "Restricted mailing list archives for WormBase developers"
	AuthType Basic
	AuthUserFile /usr/local/wormbase/conf/htpasswd
	require	user wormbase
</Directory>

<Directory /usr/local/wormbase/html/mailarch/wormbook-dev>
        AuthName "Restricted mailing list archives for WormBook developers"
        AuthType Basic
        AuthUserFile /usr/local/wormbase/conf/htpasswd
        require user wormbook
</Directory>

<Directory /usr/local/wormbase/html>
   PerlSetVar     AceBrowserConf /usr/local/wormbase/conf/elegans.pm
   PerlSetVar     AceBrowserRoot /db
   SetHandler	  perl-script
   PerlHandler    Apache::AddWormbaseBanner
   AllowOverride  FileInfo Indexes Limit Options
</Directory>

#<Directory /usr/local/wormbase/bugzilla>


<Location /bugs>
  AddHandler cgi-script .cgi
  Options +Indexes +ExecCGI +FollowSymLinks
  DirectoryIndex index.cgi
  AllowOverride Limit
  AuthType       Basic 
  AuthName       "WormBase Administrative Archive"
  AuthUserFile   /usr/local/wormbase/conf/htpasswd
  Require        valid-user
#</Directory>
</Location>

<Location /proxy>
   PerlSetVar     AceBrowserConf /usr/local/wormbase/conf/elegans.pm
   PerlSetVar     AceBrowserRoot /db
   SetHandler	  perl-script
   PerlHandler    Apache::ProxyWormAtlas
</Location>

<Location /soap>
  SetHandler perl-script
  PerlHandler Apache::SOAP
  PerlSetVar dispatch_to "NameDB"
</Location>

ScriptAlias /cgi-bin/                       /usr/local/wormbase/cgi-bin/
ScriptAlias  /squid/                        /usr/local/wormbase/squid-cgi/
Alias /bugs                                 /usr/local/wormbase/bugzilla
Alias /db/                                  /usr/local/wormbase/cgi-perl/
Alias /cb/                                  /usr/local/wormbase/cgi-perl/private/
Alias /wormbase/                     	    /usr/local/wormbase/html/
Alias /ace_images/elegans/external/movies/  /usr/local/ftp/pub/wormbase/datasets/fraser_2000/movies/
Alias /ace_images/elegans/external/         /usr/local/wormbase/html/images/expression/patterns/
Alias /dynamic_images                       /var/tmp/dynamic_images
Alias /image_uploads                        /usr/local/ftp/pub/wormbase/misc/images/

ErrorDocument 404 /db/misc/not_found
ErrorDocument 500 /db/misc/internal_server_error
#ErrorDocument 404 /errors/404
#ErrorDocument 500 /errors/505
#
#<Location /errors>
#    PerlHandler Apache::LogErrors
#</Location>

<Location /atlas>
  Options +ExecCGI
  DirectoryIndex atlas.html index.html
</Location>

<Location ~ "/atlas/.+\.cgi$">
	SetHandler cgi-script
</Location>

<Location /db/>
   SetHandler  	  perl-script
   PerlHandler    Apache::Registry
   PerlSetVar     AceBrowserConf /usr/local/wormbase/conf/elegans.pm
   PerlSetVar     AceBrowserRoot /db
   PerlSetVar     GBrowseConf  /usr/local/wormbase/conf/gbrowse.conf
   PerlSetVar     DasConfigFile  /usr/local/wormbase/conf/das.conf
   PerlSendHeader Off
   Options	  +ExecCGI
   Order allow,deny
   allow from all
   Deny from 131.243.56.46
   # LWP users at Iowa State
   Deny from 129.186.118.16
#   Deny from 64.220.237.114
   # Crawling /db
   Deny from 217.244.15.114
   Deny from 213.91.216.87
   # Add expires headers to dynamically generated pages
   ExpiresActive On
   ExpiresDefault "access plus 3 weeks"
</Location>

<Location /cb/>
   SetHandler  	  perl-script
   PerlHandler    Apache::Registry
   PerlSetVar     AceBrowserConf /usr/local/wormbase/conf/elegans.pm
   PerlSetVar     AceBrowserRoot /db
   PerlSetVar     GBrowseConf  /usr/local/wormbase/conf/gbrowse.cb.conf
   PerlSendHeader Off
   Options	  +ExecCGI
   Authname "Briggsae Analysis Group"
   AuthType Basic
   AuthUserFile /usr/local/wormbase/conf/htpasswd
   AuthGroupFile /usr/local/wormbase/conf/htgroup
   require group briggsae
</Location>

<Location /server-info>
   SetHandler server-info
</Location>

<Location /db/entry>
  AuthName "WormBase"
  AuthType Basic
  AuthUserFile /usr/local/wormbase/conf/wormbase.passwd
  order deny,allow
  allow from all
  require user wormbase
</Location>

# jakarta -- no longer needed
# include /usr/local/apache/jakarta-tomcat/conf/tomcat.conf


#Fix headers for WebDAV

BrowserMatch "^WebDAVFS/1.[012]" redirect-carefully
BrowserMatch "^WebDAVFS/1.[0123]" redirect-carefully
BrowserMatch "Microsoft Data Access Internet Publishing Provider" redirect-carefully
BrowserMatch "Microsoft-WebDAV-MiniRedir/5.1.2600" redirect-carefully
BrowserMatch "^WebDrive" redirect-carefully
BrowserMatch "^WebDAVFS" redirect-carefully

<IfModule mod_headers.c>
Header add MS-Author-Via "DAV"
</IfModule>

######################################################################


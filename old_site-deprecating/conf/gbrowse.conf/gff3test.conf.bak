[GENERAL]
description   = C. elegans GFF3 Database
db_adaptor    = Bio::DB::SeqFeature::Store
db_args       = -adaptor DBI::mysql
#                -dsn     stein_gff3
                 -dsn     ws164_gff3

# aggregators = processed_transcript match
plugins     = GFFDumper FastaDumper BatchDumper

quicklink plugins = GFFDumper FastaDumper

# list of tracks to turn on by default
default features = Genes

# The class of the objects used to establish the reference coordinates.
reference class  = 

# examples to show in the introduction
examples = I F53G12 C01A2.3

search attributes = Note

# "automatic" classes to try when an unqualified identifier is given
automatic classes = CDS

image_padding = 60

# remote GFF files to make available for optional loading
remote sources = "ORFeome STSs"      http://localhost/elegans_sts.gff
                 "Expression probes" http://localhost/elegans_expression.gff

# DAS reference server
das mapmaster = SELF

# a footer
footer = <hr>
        <table width="100%">
        <TR>
        <TD align="LEFT" class="databody">
        For the source code for this browser, see the <a href="http://www.gmod.org">
        Generic Model Organism Database Project.</a>  For other questions, send
        mail to <a href="mailto:lstein@cshl.org">lstein@cshl.org</a>.
        </TD>
        </TR>
        </table>
        <hr>
        <pre>$Id: elegans_core.conf,v 1.2 2004/02/26 21:12:17 scottcain Exp $</pre>

# Various places where you can insert your own HTML -- see configuration docs
html1 = 
html2 = 
html3 = 
html4 = 
html5 = 
html6 = 
# what image widths to offer
image widths  = 450 640 800 1024

# default width of detailed view (pixels)
default width = 800

# Web site configuration info
stylesheet  = /gbrowse/gbrowse.css
buttons     = /gbrowse/images/buttons
tmpimages   = /ace_images/gbrowse

# max and default segment sizes for detailed view
max segment     = 5000000
default segment = 5000

# zoom levels
zoom levels    = 100 200 1000 2000 5000 10000 20000 50000 100000 200000 5000000 1000000

# colors of the overview, detailed map and key
overview bgcolor = lightgrey
detailed bgcolor = lightgoldenrodyellow
key bgcolor      = beige

########################
# Default glyph settings
########################

[TRACK DEFAULTS]
glyph         = generic
height        = 10
bgcolor       = lightgrey
fgcolor       = black
font2color    = blue
label density = 25
bump density  = 100
# where to link to when user clicks in detailed view
link          = AUTO

# what to show in the overview section
[LOCI:overview]
feature       = gene:landmark
label         = 1
glyph         = generic
bgcolor       = lavender
key           = Landmarks
height        = 5

################## TRACK CONFIGURATION ####################
# the remainder of the sections configure individual tracks
###########################################################
[Genes]
feature      = gene:Coding_transcript
glyph        = gene
category     = Genes
height       = 12
bgcolor      = blue
label        = sub {
		my $f = shift;
		my $dn = $f->display_name;
		my @aliases = $f->each_tag_value('Alias');
		foreach (@aliases) {
		   return "$dn ($_)" if /^\w+-\d+/;
		}
		return $dn;
	}
description  = sub {
	my $f = shift;
	my @subf = $f->get_SeqFeatures('mRNA');
	my $note;
	for my $sf (@subf) {
	   $note ||= join '; ',$sf->each_tag_value('Note');
	}
        $note;
  }
link         = http://www.wormbase.org/db/get?name=$name;class=Gene
label_transcripts =  1
das category = transcription
key          = Genes

[Genes:150000]
glyph        = gene
maxdepth     = 1
stranded     = 1

[Transcripts:100000]
feature      = mRNA
glyph        = box
stranded     = 1

[Transcripts]
feature      = mRNA:Coding_transcript
category     = Genes
glyph        = cds
height       = 12
bgcolor      = blue
ignore_empty_phase = 1
das category = transcription
key          = Transcripts

################## VARIATION ################
[Allele]
feature      = sequence_variant:Allele
	       Allele:Allele
	       deletion:Allele 
	       substitution:Allele 
               SNP:Allele 
	       insertion:Allele
	       complex_substitution:Allele
	       transposable_element_insertion_site:Allele
               transposable_element_insertion_site:Mos_insertion_allele
	       Complex_change_in_nucleotide_sequence:Allele
category      = Variation Tracks
glyph        = sub {
		my $f = shift;
		return 'triangle' if $f->method eq 'Mos_insertion_allele';
		return 'triangle' if $f->method eq 'transposable_element_insertion_site';
		return 'box'  if $f->method =~ /complex_change/i;
#		return 'lightning'  if $f->method eq 'substitution';
#		return 'lightning'  if $f->method eq 'deletion';
		return 'diamond'  if $f->length <= 3 or $f->method eq 'SNP'; # some SNPs come out length 3 -- dunno why
		return 'generic';
	}
bgcolor      = sub {
		my $f = shift;
		my $s = $f->method;
		return 'yellow' if $f->source eq 'Mos_insertion_allele';
		return 'red'    if $s eq 'deletion';
		return 'yellow' if $s eq 'substitution';
		return 'blue'   if $s eq 'transposable_element_insertion_site';
		return 'blue'   if $s =~ /complex_change/i;
		return 'blue'   if $f->length <= 3 or $f->method eq 'SNP';
		return 'white';
	}
fgcolor      = black
font2color   = blue
height       = 8
description  = sub {
		my $f = shift;
		my $s = $f->method;
		return 'Mos insertion' if $f->source eq 'Mos_insertion_allele';
		return 'deletion'      if $s eq 'deletion';
		return 'transposon insertion' if $s eq 'transposable_element_insertion_site';
		return 'insertion'          if $s eq 'insertion';
		return 'insertion/deletion' if $s =~ /complex_change/i;
	        return 'allele'             if $f->length <= 3 and $f->method ne 'SNP';
		if ($f->length <= 3 or $f->method eq 'SNP') {
		    # Fudge factor.  Let's call the SNP verified if it has an allele-like designation
		    return 'SNP (verified)' unless ($f->name =~ /^snp_/);
		    return 'SNP (predicted)';
		}	
       	        # return 'SNP' if $f->length <= 3 or $f->method eq 'SNP';
 	}
key          = SNPs, Knockouts & Other Alleles
citation      = This track shows alleles and SNPs.  Red boxes are 
	<a href="http://elegans.bcgsc.bc.ca/knockout.shtml">Knockout Consortium</a>
	deletion alleles.  Triangles are transposon insertions engineered by Laurent Segalat and
	others [<a href="http://www.wormbase.org/db/misc/paper?name=%5Bwm99ab757%5D;class=Paper">Alvarez et al.,
	Towards a genome-wide collection of transposon insertions,International C. elegans Meeting 1999 #757</a>].
	Yellow triangles are Mos derived transposon insertions; blue triangles are Tc* derived transposon insertions.
	White boxes represent other types of alleles.

##################### REAGENTS ######################

[cDNA]
feature      = experimental:cDNA_for_RNAi
category     = Reagents
glyph        = generic
height       = 6
das category = similarity
key          = cDNA for RNAi

[Expression]
feature  = experimental_result_region:Expr_profile
category = Reagents
glyph    = generic
key      = Expression Result


######################## ALIGNMENTS ####################

[ESTB:50001]
# turn off grouping!
group_pattern = 

[ESTB:101]
fontcolor     = black
height        = 5

[ESTB]
feature      = EST_match:BLAT_EST_BEST
category     = Alignments
height       = 7
draw_target  = 1
glyph        = segments
bgcolor      = sub {
                my $feature = shift;
                my $name    = $feature->display_name;
                if ($name =~ /\.5$/) {
                   return 'red';
                } else {
                   return 'orange';
                }
        }
group_pattern = /\.[53]$/
key = ESTs aligned by BLAT (best)


[WABA]
feature       = nucleotide_match:waba_coding nucleotide_match:waba_weak nucleotide_match:waba_strong
bgcolor       = blue
glyph         = heterogeneous_segments
category      = alignments
draw_target   = 1
show_mismatch = 1
realign       = 0
category      = Alignments
waba_weak_color   = white
waba_strong_color = cornflowerblue
waba_coding_color = blue
merge_parts   = 1
fgcolor       = black
height        = 6
connector     = dashed
box_subparts  = 0
key           = Briggsae alignments
label = sub {	my $feature = shift;
		my $ref   = $feature->target;
		my $start = $feature->target->start;
		my $stop  = $feature->target->end;
	        my $first = ($feature->segments)[0];
                my $strand = defined $first && $first->start>$first->end ? -1 : +1;
		($start,$stop) = ($stop,$start) if $strand < 0;
	        "$ref:$start..$stop";
	}
citation      = These are segments of the C. briggsae rough draft sequence that have been
	aligned to the C. elegans genome using Jim Kent's WABA program [Kent & Zahler, 
	Genome Res 10:1115-25 (2000)].
	WABA distinguishes between low similarity regions (light blue), high-similarity regions
	(medium blue), and regions of high similarity that have the characteristic wobble-base
	mismatch of coding regions (dark blue).  Also see "Briggsae Alignments (BLAST)".
	IMPORTANT NOTE:  Briggsae sequence is available from the GSC BLAST server at 
	<a href="http://genome.wustl.edu/gsc/Blast/client.pl">http://genome.wustl.edu/gsc/Blast/client.pl</a> and the Sanger BLAST server
	at <a href="http://www.sanger.ac.uk/Projects/C_briggsae/blast_server.shtml">http://www.sanger.ac.uk/Projects/C_briggsae/blast_server.shtml</a>.
link = 	sub {
		my $feature = shift;
		my $ref   = $feature->target;
		my $start = $feature->target->start;
		my $stop  = $feature->target->end;
	        my $first = ($feature->segments)[0];
                my $strand = defined $first && $first->start>$first->end ? -1 : +1;
		($start,$stop) = ($stop,$start) if $strand < 0;
		return "/db/seq/ebsyn?name=$ref:$start..$stop";
	}

[WABA:100000]
feature       = nucleotide_match:waba_weak nucleotide_match:waba_strong nucleotide_match:waba_coding
glyph         = generic
bgcolor       = #E0E0E0

[TranslationF]
glyph        = translation
global feature = 1
frame0       = cadetblue
frame1       = blue
frame2       = darkblue
height       = 20
fgcolor      = purple
start_codons = 0
strand       = +1
arrow_height = 2
translation  = 3frame
category     = Sequence
key          = 3-frame translation (forward)
citation     = This track shows the position of stop codons at low magnifications,
	and the 3-frame translation at high magnifications.  Only the forward strand
	is shown.

[DNA/GC Content]
glyph          = dna
global feature = 1
strand         = both
gc_window      = 1000
height         = 40
fgcolor        = red
category       = Sequence

[TranslationR]
glyph        = translation
global feature = 1
frame0       = darkred
frame1       = red
frame2       = crimson
height       = 20
fgcolor      = blue
strand       = -1
start_codons = 0
arrow_height = 2
translation  = 3frame
category     = Sequence
key          = 3-frame translation (reverse)
citation     = This track shows the position of stop codons at low magnifications,
	and the 3-frame translation at high magnifications.  Only the reverse
	strand is shown.

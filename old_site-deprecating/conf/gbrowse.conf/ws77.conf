[GENERAL]

# wormbases-specific mod.  Turn off autocomplete
head = <script>var doAutocomplete;</script>


description = C. elegans WS77 gene predictions
adaptor     = dbi::mysqlopt
database    = dbi:mysql:database=elegans_ws77;host=localhost
aggregators = wormbase_gene clone alignment waba_alignment coding
user        = nobody
passwd      =

# Web site configuration info
stylesheet  = /stylesheets/wormbase.css
buttons     = /gbrowse/images/buttons
tmpimages   = sub {
		my ($server) = $ENV{SERVER_NAME} =~ /(.*?)\..*/;
	  	$server    ||= 'local';
  		return "/ace_images/gbrowse/$server","/var/tmp/ace_images/gbrowse";
	}

# Default glyph settings
glyph       = generic
height      = 8
bgcolor     = cyan
fgcolor     = black
label density = 25
bump density  = 100

header = sub {
	require ElegansSubs;
	require CGI;
        use constant DASVIEW => '/db/searches/dasview';
	$Ace::Browser::AceSubs::TOP = 0;
	print ElegansSubs::Banner();
	sub score_height { 
				my $feature = shift;
				my $score = $feature->score;
				my $log_score = $score <= 0 ? 0 : log $score;
				my $height    =  $log_score * 5;
				return $height < 4 ? 4 
			             : $height > 20 ? 20
			             : $height;
			}
	'';
	}

footer = sub {
	print '
	<hr>
	<table width="100%">
	<TR>
	<TD align="LEFT" class="databody">
	For the source code for this browser, see the <a href="http://www.gmod.org">
	Generic Model Organism Database Project.</a>  For other questions, send
	mail to <a href="mailto:lstein@cshl.org">lstein@cshl.org</a>.
	</TD>
	</TR>
	</table>';
	ElegansSubs::ElegansSearchBar();
	print ElegansSubs::Footer();
	return;
	}



# where to link to when user clicks in detailed view
link          = gbrowse?name=$name;source=ws77

# what image widths to offer
image widths  = 450 640 800 960 1024 1280

# default width of detailed view (pixels)
default width = 800
default features = FG GF SYNTENY

# max and default segment sizes for detailed view
max segment = 1000000
default segment = 50000

# low-res boundary
low res = 200000

# standard zoom levels to be offered to user
zoom levels    = 100 500 1000 5000 10000 20000 40000 100000 200000 500000 1000000

# fine zoom to be offered -- please provide a percentage
fine zoom      = 20%

# canonical features to show in overview
overview bgcolor = #93CBF4

# examples to show in the introduction
examples = II 
	   X:5000..10000
	   ws77.chrII.fg2
	   
# "automatic" classes to try when an unqualified identifier is given
automatic classes = Protein

# List of remote annotation sources: format is URL/name pairs separated by
# white space.  Please use quotation marks to prevent internal spaces from
# being interpreted.
# remote sources = 

# what to show in the overivew section
[Synteny:overview]
feature       = synteny_block:nonoverlapping
bgcolor       = red
fgcolor       = red
label         = 0
bump          = 1
key           = briggsae
glyph         = generic

##################################################################################
# the remainder of the sections configure particular tracks to show
##################################################################################

# the remainder of the sections configure particular features to show
[CG]
feature      = transcript:curated 
        transcript:noncoding 
        transcript:partially-coding 
        transcript:inferred-partially-coding
        transcript:RNA 
glyph        = wormbase_transcript
bgcolor      = wheat
fgcolor      = black
forwardcolor = violet
reversecolor = turquoiseutr_color    = gray
font2color   = blue
height       = 10
description  = 1
link         = http://www.wormbase.org/db/gene/gene?name=$name
title        = WormBase gene $name
key          = *Curated* Gene Models
citation     = These are gene predictions that have been reviewed by WormBase curators.  The
	purple and blue colors indicate CDS regions on the forward and reverse strands
	respectively.  The grey areas
	represent 5' and 3' ESTs assigned automatically using the extents of overlapping
	ESTs and full-length cDNAs.  The UTR predictions have <b>not</b> been reviewed by
	WormBase curators, and are known to contain artifacts.

[CG:150000]
feature      = Sequence:curated Sequence:RNA
glyph        = generic
strand_arrow = 1
link         = http://www.wormbase.org/db/gene/gene?name=$name
bgcolor      = sub {shift->strand>0?'violet':'turquoise'}

[CDS]
feature      = coding:curated
glyph        = cds
frame0f      = cadetblue
frame1f      = blue
frame2f      = darkblue
frame0r      = darkred
frame1r      = red
frame2r      = crimson
description  = 0
height       = 13
label        = CDS frame
key          = CDS
citation     = This track shows CDS reading frames.  At low magnifications, each transcript
	is shown as a "staff" of three lines.  Each line indicates a reading frame.  At high
	magnifications, the protein translation is shown.

[HYBRID]
feature      = transcript:hybrid
glyph        = wormbase_transcript
bgcolor      = blue
fgcolor      = black
forwardcolor = cyan
reversecolor = teal
font2color   = blue
description  = 1
title        = Hybrid gene $name
key          = Genes in the "hybrid" set
citation     = These are genes that have been predicted by the "hybrid" gene selection procedure which
	attempts to select genes from multiple predictions based on the greatest similarity with
        C. briggsae.

[HYBRID:150000]
glyph        = generic
strand_arrow = 1

[FG]
feature      = transcript:FGENESH
glyph        = wormbase_transcript
bgcolor      = blue
fgcolor      = black
forwardcolor = red
reversecolor = firebrick
font2color   = blue
pad_top      = sub {
		return unless $_[4]->level > 0;
		return (20-score_height(@_))/2;
	}
height       = sub { score_height(@_); }
description  = 1
title        = FGenesH gene $name
key          = FGenesH genes
citation     = These are genes that have been predicted by the FGenesH program.

[FG:75000]
feature     = Sequence:FGENESH
glyph       = generic
bgcolor     = sub {shift->strand>0?'red':'firebrick'}
height      = 12
strand_arrow = 1

[CDS FG]
feature      = coding:FGENESH
glyph        = cds
frame0f      = cadetblue
frame1f      = blue
frame2f      = darkblue
frame0r      = darkred
frame1r      = red
frame2r      = crimson
description  = 0
height       = 13
label        = CDS frame FGENESH
key          = CDS FGENESH
citation     = This track shows CDS reading frames.  At low magnifications, each transcript
	is shown as a "staff" of three lines.  Each line indicates a reading frame.  At high
	magnifications, the protein translation is shown.

[GF]
feature      = transcript:GENEFINDER_CLASSIC
feature_low  = Sequence:GENEFINDER_CLASSIC
glyph        = wormbase_transcript
bgcolor      = wheat
fgcolor      = black
forwardcolor = orange
reversecolor = darkorange
font2color   = blue
height       = 10
description  = 1
title        = Genefinder gene $name
key          = Genefinder genes
citation     = These are genes that have been predicted by the Genefinder Classic program.

[GF:75000]
feature     = Sequence:GENEFINDER_CLASSIC
glyph       = generic
bgcolor     = sub {shift->strand>0?'orange':'darkorange'}
height      = 12
strand_arrow = 1

[CDS GF]
feature      = coding:GENEFINDER_CLASSIC
glyph        = cds
frame0f      = cadetblue
frame1f      = blue
frame2f      = darkblue
frame0r      = darkred
frame1r      = red
frame2r      = crimson
description  = 0
height       = 13
label        = CDS frame Genefinder
key          = CDS Genefinder
citation     = This track shows CDS reading frames.  At low magnifications, each transcript
	is shown as a "staff" of three lines.  Each line indicates a reading frame.  At high
	magnifications, the protein translation is shown.

[WABA]
feature       = waba_alignment
bgcolor       = blue
glyph         = heterogeneous_segments
waba_weak_color   = #E0E0E0
waba_strong_color = cornflowerblue
waba_coding_color = blue
fgcolor       = black
height        = 6
connector     = dashed
box_subparts  = 1
key           = WABA alignments to briggsae
citation      = These are segments of the C. briggsae rough draft sequence that have been
	aligned to the C. elegans genome using Jim Kent's WABA program [Kent & Zahler, 
	Genome Res 10:1115-25 (2000)].
	WABA distinguishes between low similarity regions (light blue), high-similarity regions
	(medium blue), and regions of high similarity that have the characteristic wobble-base
	mismatch of coding regions (dark blue).  Also see "Briggsae Alignments (BLAST)".
link = 	sub {
		my $feature = shift;
		my $panel   = shift;
		my $length  = $panel->length;
		my $ref   = $feature->target;
		my $start = $feature->target->start;
		my $stop  = $feature->target->end;
		($start,$stop) = ($stop,$start) if $stop < $start;
		my $middle  = int(($start+$stop)/2);
		my $length2 = int($length/2);
		$start = $middle - $length2 + 1;
		$stop  = $middle + $length2;
		return "gbrowse?source=briggsae;ref=$ref;start=$start;stop=$stop";
	}

[REPEATS]
feature     = repeat:RECON
glyph       = generic
bgcolor     = red
key         = Repeats
citation    = These are repeat families called by RECON (Bao & Eddy 2002).

[TranslationF]
glyph        = translation
global feature = 1
frame0       = cadetblue
frame1       = blue
frame2       = darkblue
height       = 20
fgcolor      = purple
start_codons = 1
strand       = +1
arrow_height = 2
translation  = 3frame
key          = 3-frame translation (forward)
citation     = This track shows the position of stop codons at low magnifications,
	and the 3-frame translation at high magnifications.  Only the forward strand
	is shown.

[DNA/GC Content]
glyph          = dna
global feature = 1
height         = 40
fgcolor        = red

[TranslationR]
glyph        = translation
global feature = 1
frame0       = darkred
frame1       = red
frame2       = crimson
height       = 20
fgcolor      = blue
strand       = -1
start_codons = 1
arrow_height = 2
translation  = 3frame
key          = 3-frame translation (reverse)
citation     = This track shows the position of stop codons at low magnifications,
	and the 3-frame translation at high magnifications.  Only the reverse
	strand is shown.

[SYNTENY]
feature       = synteny_block:nonoverlapping
bgcolor       = red
fgcolor       = red
font2color    = blue
linewidth     = 3
glyph         = arrow
key           = Synteny block
citation      = These are briggsae/elegans synteny blocks which were developed
		by merging raw WABA alignments
description   = sub {
	my $feature = shift;
	my $source = $feature->ref;
	my $target = eval {$feature->target} or return;
	my ($start,$end) = ($feature->start,$feature->end);
	my ($t_start,$t_end) = ($target->start,$target->end);
	return "$source:$start..$end collinear to $target:$t_start..$t_end";
	}
link = 	sub {
	my $feature = shift;
	my $ref   = $feature->target;
	my $start = $feature->target->start;
	my $stop  = $feature->target->end;
	($start,$stop) = ($stop,$start) if $stop < $start;
	return "gbrowse?source=briggsae;ref=$ref;start=$start;stop=$stop";
	}

